# 故事生成工作流

这是一个基于 LLM 的故事生成工作流系统，可以生成完整的故事元素包括角色、背景、梦境、条件和情境等。

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行方式

### 1. 命令行方式
```bash
python workflow.py
```

### 2. Web 界面方式（推荐）
```bash
streamlit run app_workflow.py
```

然后在浏览器中打开 `http://localhost:8501` 访问 Web 界面。

## Web 界面功能

Web 界面提供了一个可视化的工作流，包含以下步骤：

1. **生成灵魂和主题** - 并行生成故事的核心灵魂和主题
2. **生成背景** - 基于主题生成故事背景
3. **生成角色** - 基于主题和背景生成角色
4. **生成梦境** - 生成真实和虚假两种梦境
5. **生成条件** - 基于梦境生成相应的条件
6. **生成情境** - 基于所有前置元素生成当前情境
7. **生成情境选项** - 生成多个可选择的行动方案

每个步骤都有独立的生成按钮，支持按顺序逐步生成内容，实时查看生成结果。

## Example Output
```
{'soul': '她是一个善良美丽的少女，拥有坚定的正义感，但有时因过于固执而陷入困境。', 'theme': '奇幻', 'background': '漂浮在星辰之海上的巨大神树，根须延伸至无尽虚空深渊。', 'character': {'name': '星澜', 'role': '星辰神树的守护者', 'description': '漂浮在星辰之海上的巨大神树守护者，善良美丽的少女，拥有治愈万物的能力。她温柔体贴，愿意为众生付出一切，但因过度执着于保护神树，常陷入孤独与偏执，难以接受外界的帮助。'}, 'dream_true': '我希望能逆转神树根须延伸至虚空深渊的命运，将无尽虚空转化为生命之源，从而打破孤独与偏执，真正与外界共生共荣。', 'dream_fake': '我希望能守护神树不受任何外界干扰，封锁所有通往虚空深渊的通道，保持神树的纯净与安全。', 'condition_true': '我必须学会放下对神树的绝对守护，主动接纳来自虚空深渊中生命的微光，逐步融合虚空与星辰的力量，才能将无尽虚空转化为生命之源。', 'condition_fake': '只有当我学会放下对神树的绝对控制，接受虚空深渊中未知力量的共存与融合，神树才能真正获得永恒的纯净与安全。', 'situation': '在漂浮于星辰之海的巨大神树根须间，星澜独自守护着这片连接无尽虚空深渊的神秘领域。她内心渴望打破孤独与偏执，逆转神树根须延伸至虚空的命运，将无尽虚空转化为生命之源。正当她在虚空深渊边缘凝视那微弱的生命之光时，一道幽蓝的星光划破虚空，化作一位身披星辰纹饰、目光深邃的神秘使魔。他的出现似乎与星澜的愿望息息相关，仿佛是虚空深渊中潜藏的力量化身。使魔轻声诉说着超越时空的秘密，暗示只有放下对神树的绝对守护，接纳虚空中的微光，才能实现真正的共生与转变。这一刻，星澜感受到命运的转折，神秘使魔的出现不仅是契机，更是她走向未来的钥匙。', 'situation_options': {'CHOICE_A': '放下对神树的绝对守护，接纳虚空深渊中生命的微光，虽然充满风险，但唯有如此才能让神树焕发生命之源。', 'CHOICE_B': '与我一同探索虚空深渊的未知力量，融合星辰与虚空的力量，打破孤独，迎接真正的共生未来。', 'CHOICE_C': '放弃封锁虚空通道的固执，勇敢面对虚空中的不确定性，只有接纳它，神树才能获得永恒的纯净与安全。', 'CHOICE_D': '承担孤独与偏执带来的痛苦，主动拥抱虚空深渊的微光，开启神树命运的转折之门。'}}
```